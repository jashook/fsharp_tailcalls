////////////////////////////////////////////////////////////////////////////////
//
// Module: iteration_helper.fs
//
////////////////////////////////////////////////////////////////////////////////

namespace ev30

////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

open System

////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

type MethodCallDelegate = delegate of int -> int

////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

type IterationHelper(iterations, callback:MethodCallDelegate) as this =
    let iterationCount = iterations
    let methodCallback = callback

    do this.MethodCall(iterationCount, methodCallback)
    
    member private this.MethodCall(iteration:int, cb:MethodCallDelegate) =
        if iteration > 0 then 
            cb.Invoke(1)

            let newIterationValue = iteration - 1
            this.MethodCall(newIterationValue, cb)